<app-navbar></app-navbar>
<div class="page">
  <form [formGroup]="formularioContra" (ngSubmit)="updatePassword()">
    <!-- Current Password -->
    <div class="form-group">
      <label for="current_password">Contraseña actual <span class="required">*</span></label>
      <div class="input-wrapper">
        <input
          #passwordInput1
          [type]="showPassword1 ? 'text' : 'password'"
          id="current_password"
          formControlName="current_password"
          placeholder=" "
        />
        <button type="button" class="toggle-btn" (click)="togglePasswordVisibility1(passwordInput1)">
          <i [class]="showPassword1 ? 'bi bi-eye' : 'bi bi-eye-slash'"></i>
        </button>
      </div>
      @if (formularioContra.controls['current_password'].touched &&
      formularioContra.controls['current_password'].getError('required')) {
        <span class="error-message">Campo requerido</span>
      }
      @if (formularioContra.controls['current_password'].touched &&
      formularioContra.controls['current_password'].getError('minlength')) {
        <span class="error-message">Mínimo 6 caracteres</span>
      }
    </div>

    <!-- New Password -->
    <div class="form-group">
      <label for="hashed_password">Nueva contraseña <span class="required">*</span></label>
      <div class="input-wrapper">
        <input
          #passwordInput2
          [type]="showPassword2 ? 'text' : 'password'"
          id="hashed_password"
          formControlName="hashed_password"
          placeholder=" "
        />
        <button type="button" class="toggle-btn" (click)="togglePasswordVisibility2(passwordInput2)">
          <i [class]="showPassword2 ? 'bi bi-eye' : 'bi bi-eye-slash'"></i>
        </button>
      </div>
      @if (formularioContra.controls['hashed_password'].touched &&
      formularioContra.controls['hashed_password'].getError('required')) {
        <span class="error-message">Campo requerido</span>
      }
      @if (formularioContra.controls['hashed_password'].touched &&
      formularioContra.controls['hashed_password'].getError('minlength')) {
        <span class="error-message">Mínimo 6 caracteres</span>
      }
      @if (formularioContra.controls['hashed_password'].touched &&
      formularioContra.controls['hashed_password'].getError('passwordStrength')) {
        <span class="error-message">
          La contraseña debe contener al menos una mayúscula, una minúscula y un número
        </span>
      }
    </div>

    <!-- Confirm Password -->
    <div class="form-group">
      <label for="confirm_password">Repetir contraseña <span class="required">*</span></label>
      <div class="input-wrapper">
        <input
          #passwordInput3
          [type]="showPassword3 ? 'text' : 'password'"
          id="confirm_password"
          formControlName="confirm_password"
          placeholder=" "
        />
        <button type="button" class="toggle-btn" (click)="togglePasswordVisibility3(passwordInput3)">
          <i [class]="showPassword3 ? 'bi bi-eye' : 'bi bi-eye-slash'"></i>
        </button>
      </div>
      @if (formularioContra.controls['confirm_password'].touched &&
      formularioContra.controls['confirm_password'].getError('required')) {
        <span class="error-message">Campo requerido</span>
      }
      @if (formularioContra.controls['confirm_password'].touched && formularioContra.hasError('matchPasswords')) {
        <span class="error-message">Las contraseñas no coinciden</span>
      }
    </div>

    <button type="submit" class="submit-button">Actualizar</button>
  </form>
</div>